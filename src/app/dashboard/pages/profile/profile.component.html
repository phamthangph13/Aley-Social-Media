<div class="profile-container" *ngIf="!isLoading">
  <!-- Error Alert -->
  <div class="alert alert-danger" *ngIf="error">
    {{ error }}
    <button (click)="error = null" class="close-btn">×</button>
  </div>

  <div class="profile-header">
    <div class="profile-cover">
      <img [src]="profile?.coverImageUrl || 'assets/images/default-cover.jpg'" alt="Cover Photo" class="cover-photo">
      <div class="cover-overlay">
        <label class="edit-btn">
          <i class="fa fa-camera"></i>
          <input type="file" accept="image/*" (change)="onCoverImageSelected($event)" style="display: none;">
        </label>
        <button class="remove-btn" (click)="removeCoverImage()" *ngIf="profile?.coverImage">
          <i class="fa fa-trash"></i>
        </button>
      </div>
    </div>
    <div class="profile-avatar">
      <img [src]="profile?.avatarUrl || 'assets/images/default-avatar.jpg'" alt="Profile Photo" class="avatar-photo">
      <div class="avatar-overlay">
        <label class="edit-btn">
          <i class="fa fa-camera"></i>
          <input type="file" accept="image/*" (change)="onAvatarSelected($event)" style="display: none;">
        </label>
        <button class="remove-btn" (click)="removeAvatar()" *ngIf="profile?.avatar">
          <i class="fa fa-trash"></i>
        </button>
      </div>
    </div>
    <div class="profile-info">
      <h2 class="profile-name" *ngIf="!isEditing">{{ profile?.firstName }} {{ profile?.lastName }}</h2>
      <p class="profile-bio" *ngIf="!isEditing && profile?.bio">{{ profile?.bio }}</p>
      <p class="profile-bio empty" *ngIf="!isEditing && !profile?.bio">Chưa có thông tin giới thiệu</p>
      
      <button class="edit-profile-btn" *ngIf="!isEditing" (click)="toggleEditMode()">
        <i class="fa fa-edit"></i> Chỉnh sửa
      </button>
    </div>
  </div>
  
  <!-- Edit Profile Form -->
  <div class="profile-edit-form" *ngIf="isEditing">
    <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
      <div class="form-group">
        <label for="firstName">Tên</label>
        <input type="text" id="firstName" formControlName="firstName" class="form-control" 
          [ngClass]="{'is-invalid': profileForm.get('firstName')?.invalid && profileForm.get('firstName')?.touched}">
        <div class="invalid-feedback" *ngIf="profileForm.get('firstName')?.errors?.['required'] && profileForm.get('firstName')?.touched">
          Tên là bắt buộc
        </div>
      </div>
      
      <div class="form-group">
        <label for="lastName">Họ</label>
        <input type="text" id="lastName" formControlName="lastName" class="form-control"
          [ngClass]="{'is-invalid': profileForm.get('lastName')?.invalid && profileForm.get('lastName')?.touched}">
        <div class="invalid-feedback" *ngIf="profileForm.get('lastName')?.errors?.['required'] && profileForm.get('lastName')?.touched">
          Họ là bắt buộc
        </div>
      </div>
      
      <div class="form-group">
        <label for="bio">Giới thiệu</label>
        <textarea id="bio" formControlName="bio" class="form-control" rows="3"></textarea>
      </div>
      
      <div class="form-group">
        <label for="location">Vị trí</label>
        <input type="text" id="location" formControlName="location" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="website">Website</label>
        <input type="text" id="website" formControlName="website" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="phoneNumber">Số điện thoại</label>
        <input type="text" id="phoneNumber" formControlName="phoneNumber" class="form-control">
      </div>
      
      <div class="form-group">
        <label for="interests">Sở thích (phân cách bằng dấu phẩy)</label>
        <input type="text" id="interests" formControlName="interests" class="form-control">
      </div>
      
      <div class="form-actions">
        <button type="submit" class="btn btn-primary" [disabled]="profileForm.invalid">Lưu</button>
        <button type="button" class="btn btn-secondary" (click)="toggleEditMode()">Hủy</button>
      </div>
    </form>
  </div>
  
  <div class="profile-content" *ngIf="!isEditing">
    <div class="profile-section">
      <h3>Thông tin cá nhân</h3>
      
      <div class="info-item" *ngIf="profile?.location">
        <span class="label">Vị trí:</span>
        <span class="value">{{ profile.location }}</span>
      </div>
      
      <div class="info-item" *ngIf="profile?.website">
        <span class="label">Website:</span>
        <span class="value">
          <a [href]="profile.website" target="_blank">{{ profile.website }}</a>
        </span>
      </div>
      
      <div class="info-item" *ngIf="profile?.phoneNumber">
        <span class="label">Điện thoại:</span>
        <span class="value">{{ profile.phoneNumber }}</span>
      </div>
      
      <div class="info-item" *ngIf="profile?.interests && profile.interests.length > 0">
        <span class="label">Sở thích:</span>
        <span class="value">
          <span class="interest-tag" *ngFor="let interest of profile.interests">{{ interest }}</span>
        </span>
      </div>
      
      <div class="empty-state" *ngIf="!profile?.location && !profile?.website && !profile?.phoneNumber && (!profile?.interests || profile.interests.length === 0)">
        Chưa có thông tin cá nhân nào được thêm.
      </div>
    </div>
  </div>
</div>

<!-- Loading Spinner -->
<div class="loading-spinner" *ngIf="isLoading">
  <div class="spinner"></div>
  <p>Đang tải thông tin...</p>
</div> 